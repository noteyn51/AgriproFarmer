<ion-view hide-back-button="false" cache-view="true">
  <!-- <ion-nav-buttons side="left">
    <button class="button button-clear ion-chevron-left" ng-click="vm.goBack()" style="color:white;font-weight: 400;">
      Back</button>
  </ion-nav-buttons> -->
  <ion-nav-title>รายการกิจกรรม
  </ion-nav-title>
  <ion-nav-buttons side="right">
    <button type="button" class="button button-clear" ng-click="vm.hist()" style="color:white;font-weight: bold;">
      <i class="icon">
        <img src="img/iconOP/hist.png" style="width: 35px;
        height: 35px;">
      </i>
    </button>
  </ion-nav-buttons>
  <style>
    .abc:active {
      transform: scale(0.8);
    }

  </style>
  <!-- <button type="button" class="abc button button-large " style="position: absolute;
  z-index: 50;
  bottom: 5%;
  left: 5%;
  border-radius: 50%;
  min-height:55px;
  min-width:55px;
  background-color:#0C9;
	color:#FFF;
	text-align:center;
  box-shadow: 2px 2px 3px #999;
  " ng-click="vm.addcrop()">
    <i class="icon ion-plus-round"></i>
  </button> -->
  <style>
    .scroll {
      height: 120%;
    }

    .dp-flex {
      display: flex;
      justify-content: space-between;
    }

  </style>

  <ion-content style="background:#f5f5f5;">
    <ion-refresher pulling-text="Pull to refresh" on-refresh="doRefresh()"></ion-refresher>



    <!-- <div class="item item-divider" style="text-align:center">
          <h2 style="font-size: 16pt"> <i class="icon ion-person"></i> {{crop.frm_fname}} {{crop.frm_lname}}</h2>
        </div> -->

    <div ng-if="idSelected">

      <div class="list">

        <div class="item " style="
      /* margin: 10px;
      border-radius: 20px; */
      display: flex;
      padding: 0px;">
          <div style="width: 80%;
      padding: 10px 15px;white-space: initial;">
            <div class="dp-flex"><a> <span style="font-weight: bold;">ID </span>: {{idSelected.wo_lot}}</a> </div>
            <div class="dp-flex"><a> <span style="font-weight: bold;">พื้นที่ </span>: {{idSelected.farm_name}}</a>
            </div>
            <div class="dp-flex">
              <a>
                <!-- <span style="font-weight: bold;"> เลขที่รายการ </span>: {{idSelected.wo_lot}} -->
                <span style="font-weight: bold;"> รายการ </span>: {{idSelected.pt_desc1}}</a> </div>
            <div class="dp-flex"> </div>
            <div class="dp-flex"><a><span style="font-weight: bold;">ขนาด </span>: {{idSelected.farm_area_farm |number}}
                ไร่
                {{idSelected.farm_area_work |number}} งาน {{idSelected.farm_area_wah |number}} ตารางวา</a>
            </div>
            <div class="dp-flex"><a> <span style="font-weight: bold;">จำนวนวันที่ปลูก-เลี้ยง </span>:
                {{idSelected.difdate}} วัน</a> </div>
          </div>
          <div class="button" href="" style="width: 20%;
      background-color: green;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;" ng-click="openModalMyId()">
            <div>
              เปลี่ยน
            </div>
          </div>
        </div>


        <div class="item " style="margin-top: 10px;" ng-if="vm.route.resultToday">
          <div style="font-size: larger;font-weight: bold;margin-bottom: 10px;">กิจกรรมที่ต้องทำวันนี้</div>

          <div class="item " style="
        margin: 10px 0px 10px 0px;
        border-radius: 20px;
        display: flex;
        padding: 0px;
        height: 80px;" ng-repeat="k in  vm.route.resultToday track by $index">
            <div class="button" href="" style="width: 20%;
             background-color: rgb(56,128,255);
             display: flex;
             align-items: center;
             justify-content: center;
             color: white;" ng-style="k.between == false && {'background-color': 'rgba(56,128,255,0.4)'} ">
              <div>
                {{k.subdatedesc}}
              </div>
            </div>
            <div style="width: 60%;
        padding: 5px;align-self: center;">
              <div class="dp-flex" style="justify-content: center;">
                <a style="width: 100%;" ng-style="k.between == false && {'color': 'rgba(000,000,000, 0.4)'} ">
                  <div style="font-weight: bold;font-size: larger;">
                    {{k.ro_desc}} </div>
                  <div style="text-overflow: ellipsis;
              white-space: nowrap;
              overflow: hidden;">
                    {{k.ro__chr01}} </div>
                </a>
              </div>

            </div>

            <div class="button " href="" style="width: 20%;
          background-color: rgb(56, 255, 99);
          display: flex;
          align-items: center;
          justify-content: center;
          color: white;font-weight: bold;"
              ng-style="k.between == false && {'background-color': 'rgba(56, 255, 99,0.4)'} " ng-click="vm.detail2(k)">
              <div>
                บันทึก
              </div>
            </div>

          </div>

          <div style="text-align: center;"
            ng-style="vm.route.resultToday[0].op_date == 'false' && {'color': 'red'} || {'color': 'green'} ">
            {{vm.route.resultToday[0].op_date_desc}}</div>
        </div>

        <div class="item item-icon-right" ng-click="vm.detailDisease()">
          <div style="font-size: larger;">โรคและแมลงที่ตรวจพบ</div>
          <i class="icon ion-ios-arrow-right"></i>
        </div>
        <div class="item item-icon-right" ng-click="vm.detailGrowth()">
          <div style="font-size: larger;">การเจริญเติบโต</div>
          <i class="icon ion-ios-arrow-right"></i>
        </div>




        <div class="item " style="margin-top: 10px;" ng-if="vm.route.result">
          <div style="font-size: larger;font-weight: bold;margin-bottom: 10px;">กิจกรรมตลอดกระบวนการ</div>

          <div class="item " style="
        margin: 10px 0px 10px 0px;
        border-radius: 20px;
        display: flex;
        padding: 0px;
        height: 80px;" ng-repeat="k in  vm.route.result track by $index" ng-click="vm.detail2(k)">
            <div class="button" href="" style="width: 20%;
             background-color: rgb(56,128,255);
             display: flex;
             align-items: center;
             justify-content: center;
             color: white;" ng-style="k.between == false && {'background-color': 'rgba(56,128,255,0.4)'} ">
              <div>

                {{k.subdatedesc}}
              </div>
            </div>
            <div style="width: 60%;
        padding: 5px;align-self: center;">
              <div class="dp-flex" style="justify-content: center;">
                <a style="width: 100%;" ng-style="k.between == false && {'color': 'rgba(000,000,000, 0.4)'} ">
                  <div style="font-weight: bold;font-size: large;">
                    {{k.ro_desc}} </div>
                  <div style="text-overflow: ellipsis;
              white-space: nowrap;
              overflow: hidden;">
                    {{k.ro__chr01}} </div>
                </a>
              </div>

            </div>
          </div>

        </div>
      </div>
    </div>



    <div style="font-size: 25pt;
      text-align: center;
      color: gray;
      margin-top: 60px;" ng-if="!vm.route.result &&  !vm.route.resultToday">ยังไม่มีการเริ่มกิจกรรม</div>





    <!-- <h3 style="text-align: center;color:gray;margin-top:20%" ng-if="data.status == false && status == true">
      ยังไม่ได้สร้างพื้นที่ </h3> -->
    <h3 ng-click="vm.refresh()" style="text-align: center;color:gray;margin-top:20%" ng-if="status == false">
      เกิดข้อผิดพลาดในการเชื่อมต่อลองใหม่อีกครั้ง
      <i class="icon ion-refresh"></i>
    </h3>

    <div ng-if="!data" style="margin-top:20% ">
      <ion-spinner icon="spiral" class="spinner-dark" style="position: absolute; zoom:2;display: inline-block;left:45%">
      </ion-spinner>
    </div>


    </ul>
    </div>

    <script id="my-modaledit.html" type="text/ng-template">
      <ion-modal-view style="bottom:10%;border-raduius:10px;border-radius: 10px;">
          <ion-header-bar>
              <button type="button" class="button button-assertive button-clear" ng-click="closeModalEdit()">close</button>
            <h1 class="title" style="text-align:center">แก้ไขพื้นที่</h1>
            <button type="button" class="button icon ion-trash-a button-assertive button-outline" ng-click="vm.deleteCrop()" ></button>
          </ion-header-bar>
          <ion-content >
            <div class="list " style="border-radius: 15px;">
            
            
              <div class="item item-avatar item-icon-right" ng-click="vm.editMap()">
                  <img src="img/ServiceArea.png">
                  <h2 style="font-weight: bold">พิกัดพื้นที่</h2>
                  <p>{{positionEdit.lat[0]}} , {{positionEdit.lng[0]}}</p>
                  <i class="icon ion-chevron-right"></i>
                  
                </div>
    
            <div class="list">
              <label class="item item-input item-stacked-label">
                <span class="input-label">ชื่อ Farm</span>
                <input type="text" placeholder="ชื่อ" ng-model="editdata.farm_name">
              </label>
      
  <!-- 
              <div class="row" style="margin-top:5px">
                <div class="col">
      
                  <span class="input-label bold" style="width:100%">ผู้ดูแลฟาร์ม </span>
                  <select class="form-control sel inp" ng-options="item as item.mob_username+' '+'('+item.mob_fname+' '+item.mob_lname+')'  for item in data.select track by item.mob_fname"
                  ng-model="editdata.createname" >
                </select>
                  
                </select>
                </div>
              </div> -->
              <label class="item item-input item-stacked-label">
                <span class="input-label">รายละเอียด</span>
                <input type="text" placeholder="รายละเอียด" ng-model="editdata.farm_desc">
              </label>
              <div class="item item-avatar item-icon-right" >
                <img src="img/calendar.png">
                <h2 style="color:#036d8e">วันที่สร้าง</h2>
                <p>{{editdata.farm_startt}}</p>
                <i class="icon ion-edit"  ng-click="vm.updatepickdate()"></i>
           
              </div>
              <!-- <div class="item item-avatar item-icon-right" >
                <img src="img/calendar.png">
                <h2 style="color:#036d8e">วันที่สิ้นสุด</h2>
                <p>{{editdata.farm_endt}}</p>
                <i class="icon ion-edit"  ng-click="vm.updatepickdateto()"></i>
           
              </div> -->
           
              <div></div>
      
            </div>
      
      
            <div class="container">
              <table id="customers">
                <tr>
                  <th width="33%" style="text-align:center">ไร่</th>
                  <th width="33%" style="text-align:center">งาน</th>
                  <th width="33%" style="text-align:center">ตารางวา</th>
                </tr>
                <tr>
                  <td><input type="text" ng-model="editdata.farm_area_farm" id="inp001" class="form-control" /></td>
                  <td><input type="text" ng-model="editdata.farm_area_work" id="inp002" class="form-control" /></td>
                  <td><input type="text" ng-model="editdata.farm_area_wah" id="inp003" class="form-control" /></td>
                </tr>
              </table>
            </div>
  
            <div class="container" style="margin-top:20px">
              <button type="button" class="button button-balanced button-block" ng-click="vm.updateCrop()" ng-disabled="checkUpdate()" style="border-radius: 10px;">บันทึก</button>
  
            </div>
          </ion-content>
        </ion-modal-view>
      </script>

    <script id="my-wo-id.html" type="text/ng-template">
      <ion-modal-view style="bottom:10%;border-raduius:10px;border-radius: 10px;">
            <ion-header-bar>
                <button type="button" class="button button-assertive button-clear" ng-click="closeModalMyId()">close</button>
              <h1 class="title" style="text-align:center">รายการ</h1>
              <!-- <button type="button" class="button icon ion-trash-a button-assertive button-outline" ng-click="vm.deleteCrop()" ></button> -->
            </ion-header-bar>
            <ion-content >
              <div class="list" >
                <div
                  class="item"
                  style="margin-bottom: 10px;white-space: initial;"
                  ng-click="selectID(x)"
                  ng-repeat="x in vm.list.result track by $index"
                  
                >
                  <div style="display: flex; justify-content: space-between;">
                    {{x.wo_nbr}} - {{x.pt_desc1}}  <a>เลขที่รายการ :&nbsp;{{x.wo_lot}}</a>
                  </div>
          
                  <div style="display: flex; justify-content: space-between;">
                    <a>{{x.farm_name}}</a>
                    <a>
                        <span ng-if="x.mim_status == 'CONFIRM'"><i style="color:green" class="icon ion-checkmark-circled"></i></span>
                        {{x.ml_status_desc}}</a>
                  </div>
                  <!-- <h2>{{x.subdatedesc}}</h2> -->
          
                  <!-- <div ng-style="x.ml_status_desc == 'ชำระเงินแล้ว' ?  {'background-color':'green'} : {'background-color': 'yellow'}" style="width:200px;height:100px;border:1px solid gray;"></div> -->
                  <div  class="dp-flex"> 
                    <a>วันที่เริ่ม : {{x.datedesc}}</a>
                    <a style="color:green;font-weight: bold;">{{x.mid_total | currency : value="฿ "}}</a>
                  </div>
                </div>
               
              </div>
            </ion-content>
          </ion-modal-view>
        </script>


    <script id="my-crop.html" type="text/ng-template">
      <ion-modal-view>
  
        
  
          <ion-header-bar>
            <button type="button" class="button button-assertive button-clear" ng-click="closeModalCrop()">close</button>
            <h1 class="title" style="text-align:center">เลือกCROP</h1>
          </ion-header-bar>
  
          <ion-content >
          <ion-slide-box ng-init="lockSlide()"  show-pager="false">
           <ion-slide >
            <div class="list">
              <a class="item  item-button-right " ng-repeat="k in mstrCrop">
  
                <h2>{{k.crop_code}}</h2>
                <p>{{k.crop_desc}}</p>
                <p>เริ่ม : {{k.crop_start_date}} สิ้นสุด : {{k.crop_stop_date}}</p>
           
  
                <button type="button" class="button button-positive" style="height:50%;top: 30%;border-radius: 10px;" ng-click="vm.mstrCropSelect(k)">
                    เลือก
                  </button>
       
  
              </a>
          </div>
        </ion-slide >
      </ion-slide-box>
  
          </ion-content>
  
   
  
  
        </ion-modal-view>
      </script>


    <script id="my-map.html" type="text/ng-template">
      <ion-modal-view style="bottom:10%;border-raduius:10px;border-radius: 10px;">
          <ion-header-bar>
              <button type="button" class="button button-assertive button-clear" ng-click="closeModalMap()">close</button>
            <h1 class="title" style="text-align:center">map</h1>
            <!-- <button type="submit" class="button icon ion-trash-a button-assertive button-outline" ng-click="vm.deleteCrop()" ></button> -->
          </ion-header-bar>
          <ion-content  class="wrapper_all" scroll="false">
           
  
              <button type="button" class="button button-balanced" ng-click="vm.save()" style="text-align: center;position:absolute;z-index:2;top:60px;right:10px;margin-left:10px;border-radius: 20px;border-color: black">Save</button>
                      <div id="maps"></div>
  
          </ion-content>
        </ion-modal-view>
      </script>


  </ion-content>
</ion-view>
